3:I[3754,[],""]
5:I[7754,[],""]
6:I[7574,["18","static/chunks/18-a08db35d0c492fb3.js","802","static/chunks/802-8624e27f06c26e64.js","333","static/chunks/app/posts/%5Bslug%5D/page-113a3a94ad4fe476.js"],"default"]
7:I[8750,["18","static/chunks/18-a08db35d0c492fb3.js","802","static/chunks/802-8624e27f06c26e64.js","333","static/chunks/app/posts/%5Bslug%5D/page-113a3a94ad4fe476.js"],""]
4:["slug","patching-with-pnpm","d"]
0:["bVXrX63nls6mz3NDAu0w6",[[["",{"children":["posts",{"children":[["slug","patching-with-pnpm","d"],{"children":["__PAGE__?{\"slug\":\"patching-with-pnpm\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["posts",{"children":[["slug","patching-with-pnpm","d"],{"children":["__PAGE__",{},[["$L1","$L2",null],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/997bb99dff39a320.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$L6",null,{"title":"naturalclar.dev","children":[["$","h1",null,{"children":"404 - Page Not Found"}],["$","p",null,{"children":"You just hit a route that doesn't exist... the sadness."}],["$","p",null,{"children":["$","$L7",null,{"href":"/","children":"Go back to the homepage"}]}]]}],"notFoundStyles":[]}]}]}]],null],null],["$L8",null]]]]
a:I[4802,["18","static/chunks/18-a08db35d0c492fb3.js","802","static/chunks/802-8624e27f06c26e64.js","333","static/chunks/app/posts/%5Bslug%5D/page-113a3a94ad4fe476.js"],"Image"]
9:Tb72,<h2><code>pnpm</code> で <code>node_modules</code> 内のパッケージにパッチを当てる方法</h2>
<p>プロジェクトで <code>node_modules</code> の中にある特定のパッケージに変更を加える必要がある場面に直面した。</p>
<h3><code>yarn</code> v1 での対応</h3>
<p>以前はパッケージマネージャとして <code>yarn</code> v1 を採用していて、その時は <a href="https://github.com/ds300/patch-package">patch-package</a> を使うことで対応することができた。</p>
<p><code>patch-package</code> を使う際はまず <code>node_modules</code> の中身のファイルを必要に応じて書き換えて、その後に以下のコマンドを使うことでパッチファイルが作成できた。</p>
<pre><code class="language-sh">npx patch-package [パッケージ名]
</code></pre>
<p>パッチを反映させるには、<code>postinstall</code> 等のスクリプトで <code>patch-package</code> を実行することによって作成したパッチの内容が <code>node_modules</code> に反映された。</p>
<pre><code class="language-json">{
  "scripts": {
    "postinstall": "patch-package"
  }
}
</code></pre>
<h3><code>pnpm</code> での対応</h3>
<p><code>pnpm</code> では <code>node_modules</code> が symlink で管理されているため <code>node_modules</code> を直接書き換える対応は行えない。<code>patch-package</code> も <code>pnpm</code> には非対応である。</p>
<p>その代わり、<code>pnpm</code> は独自のパッチ機構を持っている。</p>
<h2><code>pnpm patch</code></h2>
<p><a href="https://pnpm.io/cli/patch">pnpm patch</a></p>
<pre><code class="language-sh">pnpm patch &#x3C;pkg name>@&#x3C;version>
</code></pre>
<p>実行すると以下の様なメッセージが表示され、パッケージの内容が作成される</p>
<pre><code>You can now edit the following folder: /private/var/folders/5t/lpfk4v1s7fqcpf1k1yjnnv3w0000gn/T/d9cfbc08a0261088f439bb943285e960

Once you're done with your changes, run "pnpm patch-commit /private/var/folders/5t/lpfk4v1s7fqcpf1k1yjnnv3w0000gn/T/d9cfbc08a0261088f439bb943285e960"
</code></pre>
<p>作成されたフォルダの中で必要な変更を行い、以下のコマンドを実行すると</p>
<pre><code class="language-sh">pnpm patch-commit [作成されたフォルダのパス]
</code></pre>
<p>特に他の指定をしてない場合、プロジェクトに<code>patches</code>フォルダが作成され、そこにパッチファイルが生成される。</p>
<p>また、<code>package.json</code>に以下のような記述が追記される。</p>
<pre><code class="language-json">{
  "pnpm": {
    "patchedDependencies": {
      "package@1.0.0": "patches/@package@1.0.0.patch"
    }
  }
}
</code></pre>
<p>これで次回から<code>pnpm install</code>を実行する際にパッチファイルが適用される。</p>
2:["$","$L6",null,{"title":"naturalclar.dev","children":[["$","h1",null,{"children":"patching-with-pnpm"}],["$","p",null,{"style":{"display":"block","marginBottom":"16px"},"children":"January 06, 2024"}],["$","div",null,{"dangerouslySetInnerHTML":{"__html":"$9"}}],["$","hr",null,{"style":{"marginBottom":"16px"}}],["$","div",null,{"style":{"display":"flex","alignItems":"center","marginBottom":"40px"},"children":[["$","$La",null,{"src":"https://www.github.com/Naturalclar.png","width":50,"height":50,"alt":"Naturalclar (Jesse Katsumata)","style":{"marginRight":"16px","marginBottom":0,"minWidth":50,"borderRadius":"100%"}}],["$","div",null,{"style":{"display":"flex","flexDirection":"column","gap":"8px"},"children":[["$","p",null,{"style":{"margin":0},"children":["Author: ",["$","strong",null,{"children":"Naturalclar (Jesse Katsumata)"}]]}],["$","p",null,{"style":{"margin":0},"children":[["$","a",null,{"href":"https://x.com/natural_clar","children":"X"}]," ",["$","a",null,{"href":"https://www.github.com/Naturalclar","children":"Github"}]]}]]}]]}],["$","ul",null,{"style":{"display":"flex","flexWrap":"wrap","justifyContent":"space-between","listStyle":"none","padding":0},"children":[["$","li",null,{"children":["$","$L7",null,{"href":"/posts/setting-up-nvim-setting-for-windows-powershell","rel":"prev","children":["← ","Windows の PowerShell で dotfiles にある neovim 用の init.vim を設定する方法"]}]}],["$","li",null,{"children":["$","$L7",null,{"href":"/posts/writing-native-module-in-swift","rel":"next","children":["React Native の Native Module を Swift で書く"," →"]}]}]]}]]}]
8:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"patching-with-pnpm | naturalclar.dev"}],["$","meta","3",{"name":"description","content":"\n## `pnpm` で `node_modules` 内のパッケージにパッチを当てる方法\n\nプロジェクトで `node_modules` の中にある特定のパッケージに変更を加える必要がある場面に直面した。\n\n### `yarn` v1 での対応\n\n以前はパッケージマネージャとして `yarn` v1 を採用していて、その時は [patch-package](https://github.com/..."}],["$","meta","4",{"name":"author","content":"Naturalclar (Jesse Katsumata)"}],["$","meta","5",{"name":"keywords","content":"react, react-native, nextjs, blog"}],["$","meta","6",{"name":"creator","content":"Naturalclar (Jesse Katsumata)"}],["$","meta","7",{"name":"publisher","content":"Naturalclar (Jesse Katsumata)"}],["$","meta","8",{"name":"robots","content":"index, follow"}],["$","meta","9",{"property":"og:title","content":"patching-with-pnpm | naturalclar.dev"}],["$","meta","10",{"property":"og:description","content":"\n## `pnpm` で `node_modules` 内のパッケージにパッチを当てる方法\n\nプロジェクトで `node_modules` の中にある特定のパッケージに変更を加える必要がある場面に直面した。\n\n### `yarn` v1 での対応\n\n以前はパッケージマネージャとして `yarn` v1 を採用していて、その時は [patch-package](https://github.com/..."}],["$","meta","11",{"property":"og:url","content":"https://blog.naturalclar.dev/"}],["$","meta","12",{"property":"og:site_name","content":"naturalclar.dev"}],["$","meta","13",{"property":"og:image","content":"https://blog.naturalclar.dev/twitter-card.png"}],["$","meta","14",{"property":"og:image:width","content":"1200"}],["$","meta","15",{"property":"og:image:height","content":"630"}],["$","meta","16",{"property":"og:image:alt","content":"patching-with-pnpm"}],["$","meta","17",{"property":"og:type","content":"website"}],["$","meta","18",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","19",{"name":"twitter:creator","content":"@natural_clar"}],["$","meta","20",{"name":"twitter:title","content":"patching-with-pnpm | naturalclar.dev"}],["$","meta","21",{"name":"twitter:description","content":"\n## `pnpm` で `node_modules` 内のパッケージにパッチを当てる方法\n\nプロジェクトで `node_modules` の中にある特定のパッケージに変更を加える必要がある場面に直面した。\n\n### `yarn` v1 での対応\n\n以前はパッケージマネージャとして `yarn` v1 を採用していて、その時は [patch-package](https://github.com/..."}],["$","meta","22",{"name":"twitter:image","content":"https://blog.naturalclar.dev/twitter-card.png"}]]
1:null
